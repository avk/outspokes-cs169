var msie6=$.browser.msie&&$.browser.version=="6.0";var Opera=$.browser.opera;var zi=100;jQuery.fn.buildContainers=function(a){return this.each(function(){if($(this).is("[inited=true]")){return}this.options={containment:"document",elementsPath:"elements/",onMinimize:function(){},onIconize:function(){},onClose:function(){}};$.extend(this.options,a);var b=$(this);b.attr("inited","true");if($.metadata){$.metadata.setType("class");if(b.metadata().skin){b.attr("skin",b.metadata().skin)}if(b.metadata().minimized){b.attr("minimized",b.metadata().minimized)}if(b.metadata().iconized){b.attr("iconized",b.metadata().iconized)}if(b.metadata().icon){b.attr("icon",b.metadata().icon)}if(b.metadata().buttons){b.attr("buttons",b.metadata().buttons)}if(b.metadata().width){b.attr("width",b.metadata().width)}if(b.metadata().height){b.attr("height",b.metadata().height)}}b.addClass(b.attr("skin"));if(!b.attr("minimized")){b.attr("minimized","false")}b.find(".n:first").attr("unselectable","on");if(!b.find(".n:first").html()){b.find(".n:first").html("&nbsp;")}b.setIcon(b.attr("icon"),this.options.elementsPath);b.setButtons(b.attr("buttons"),this.options);if(b.attr("width")){b.css({width:b.attr("width")+"px"})}if(b.attr("height")){b.find(".c:first , .content:first").css("height",b.attr("height")-b.find(".n:first").outerHeight()-(b.find(".s:first").outerHeight()))}if(b.hasClass("draggable")){b.css({position:"absolute",margin:0});b.find(".n:first").css({cursor:"move"});b.css({zIndex:zi++});b.draggable({handle:".n:first",cancel:".c",delay:0,containment:this.options.containment});b.mousedown(function(){$(this).mb_BringToFront()})}if(b.hasClass("resizable")){b.containerResize()}if(b.attr("minimized")=="true"){b.attr("minimized","false");b.minimize(this.options.elementsPath,this.options.onMinimize)}if(b.attr("iconized")=="true"){b.attr("iconized","false");b.iconize(this.options.onIconize)}})};jQuery.fn.containerResize=function(){var a=$(this).hasClass("draggable");$(this).resizable({handles:a?"":"s",minWidth:150,minHeight:150,iframeFix:true,helper:"mbproxy",start:function(b,c){c.helper.mb_BringToFront()},stop:function(f,g){var d=msie6||Opera?g.helper:$(this);var b=d.outerHeight()-$(this).find(".n:first").outerHeight()-($(this).find(".s:first").outerHeight());$(this).find(".c:first , .content:first").css({height:b});if(!a){var c=$(this).attr("width")&&$(this).attr("width")>0?$(this).attr("width"):"100%";$(this).css({width:c})}}});$(this).find(".ui-resizable-s").addClass("mb-resize");$(this).find(".ui-resizable-se").addClass("mb-resize");$(this).find(".ui-resizable-w").addClass("mb-resize");$(this).find(".ui-resizable-e").addClass("mb-resize")};jQuery.fn.resizeTo=function(d,b){var c=$(this).hasClass("draggable");if(!b){b=$(this).outerWidth()}if(!d){d=$(this).outerHeight()}var a=d-$(this).find(".n:first").outerHeight()-($(this).find(".s:first").outerHeight());$(this).find(".c:first , .content:first").animate({height:a});$(this).animate({height:d});$(this).animate({width:b})};jQuery.fn.setIcon=function(a,b){if(a&&a!=""){$(this).find(".ne:first").prepend("<img class='icon' src='"+b+"icons/"+a+"' style='position:absolute'>");$(this).find(".n:first").css({paddingLeft:15})}else{$(this).find(".n:first").css({paddingLeft:0})}};jQuery.fn.setButtons=function(f,e){var g=e.elementsPath;var a=$(this);if(f!=""){var d=f.split(",");$(this).find(".ne:first").append("<div class='buttonBar'></div>");for(var c in d){if(d[c]=="c"){$(this).find(".buttonBar:first").append("<img src='"+g+$(this).attr("skin")+"/close.png' class='close'>");$(this).find(".close:first").bind("click",function(){a.fadeOut(200);e.onClose()})}if(d[c]=="m"){$(this).find(".buttonBar:first").append("<img src='"+g+$(this).attr("skin")+"/min.png' class='minimizeContainer'>");$(this).find(".minimizeContainer:first").bind("click",function(){a.minimize(g,e.onMinimize)});$(this).find(".n:first").bind("dblclick",function(){a.minimize(g,e.onMinimize)})}if(d[c]=="p"){$(this).find(".buttonBar:first").append("<img src='"+g+$(this).attr("skin")+"/print.png' class='printContainer'>");$(this).find(".printContainer:first").bind("click",function(){})}if(d[c]=="i"){$(this).find(".buttonBar:first").append("<img src='"+g+$(this).attr("skin")+"/iconize.png' class='iconizeContainer'>");$(this).find(".iconizeContainer:first").bind("click",function(){a.iconize(e.onIconize)})}}var b=$.browser.mozilla||$.browser.safari;$(this).find(".buttonBar:first img").css({opacity:0.5,cursor:"pointer"}).mouseover(function(){if(b){$(this).fadeTo(200,1)}}).mouseout(function(){if(b){$(this).fadeTo(200,0.5)}})}};jQuery.fn.minimize=function(a,b){this.each(function(){var c=$(this);if($(this).attr("minimized")=="false"){this.w=c.outerWidth();this.h=c.outerHeight();c.find(".icon:first").hide();c.find(".o:first").slideUp(100,function(){});c.animate({height:c.find(".n:first").outerHeight()+c.find(".s:first").outerHeight()},100,function(){c.find(".icon:first").show()});c.attr("minimized","true");c.find(".minimizeContainer:first").attr("src",a+$(this).attr("skin")+"/max.png");c.resizable("destroy");b()}else{c.find(".o:first").slideDown(100,function(){});if(c.hasClass("resizable")){c.containerResize()}c.attr("minimized","false");c.find(".icon:first").hide();c.animate({height:this.h},100,function(){c.find(".icon:first").show()});c.find(".minimizeContainer:first").attr("src",a+$(this).attr("skin")+"/min.png")}})};jQuery.fn.iconize=function(a){return this.each(function(){var b=$(this);if(b.attr("minimized")=="false"){b.attr("w",b.attr("width")&&b.attr("width")>0?(!b.hasClass("resizable")?b.attr("width"):b.width()):"100%");b.attr("h",b.height())}b.attr("t",b.css("top"));b.attr("l",b.css("left"));b.resizable("destroy");if(!$.browser.msie){b.find(".no:first").fadeOut("fast");b.animate({height:"32px",width:"32px",left:0},200)}else{b.find(".no:first").hide();b.css({height:"32px",width:"32px",left:0})}b.append("<img src='elements/icons/"+(b.attr("icon")?b.attr("icon"):"restore.png")+"' class='restoreContainer' width='32'>");if(a){a()}b.find(".restoreContainer:first").bind("click",function(){if(!$.browser.msie){b.find(".no:first").fadeIn("fast");if(b.attr("minimized")=="false"){b.animate({height:b.attr("h"),width:b.attr("w"),left:b.attr("l")},200)}else{b.animate({height:"60px",width:b.attr("w"),left:b.attr("l")},200)}b.find(".c:first , .content:first").css("height",b.attr("h")-b.find(".n:first").outerHeight()-(b.find(".s:first").outerHeight()))}else{b.find(".no:first").show();b.css({width:b.attr("w"),left:b.attr("l")});b.find(".c:first , .content:first").css("height",b.attr("h")-b.find(".n:first").outerHeight()-(b.find(".s:first").outerHeight()))}b.find(".restoreContainer:first").remove();if(b.hasClass("resizable")&&b.attr("minimized")=="false"){b.containerResize()}})})};jQuery.fn.mb_BringToFront=function(){var a=10;$("*").each(function(){if($(this).css("position")=="absolute"){var b=parseInt($(this).css("zIndex"));a=b>a?parseInt($(this).css("zIndex")):a}});$(this).css("zIndex",a+=1)};